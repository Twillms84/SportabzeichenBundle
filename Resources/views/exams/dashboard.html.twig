{% extends "@IServCore/page.html.twig" %}

{% block page_title %}
    {{ 'Sportabzeichen – Ergebnisse'|trans }}
{% endblock %}

{% block page_content %}
<div class="content">

    <h2>{{ 'Ergebnisverwaltung'|trans }}</h2>

    {# ------------------------------------------------------------
       Prüfung auswählen
       ------------------------------------------------------------ #}
    <form method="get" class="form-inline mb-4">
        <div class="form-group">
            <label for="exam" class="control-label">
                {{ 'Prüfung auswählen'|trans }}
            </label>

            <select name="exam" id="exam" class="form-control" onchange="this.form.submit()">
                <option value="">
                    -- {{ 'Bitte wählen'|trans }} --
                </option>

                {% for exam in exams %}
                    <option value="{{ exam.id }}"
                        {{ exam.id == selectedExam ? 'selected' }}>
                        {{ exam.exam_year }}
                        {% if exam.exam_name %}
                            – {{ exam.exam_name }}
                        {% endif %}
                    </option>
                {% endfor %}
            </select>
        </div>
    </form>

    {# ------------------------------------------------------------
       Teilnehmerliste
       ------------------------------------------------------------ #}
    {% if selectedExam and participants is not empty %}

        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>{{ 'Import-ID'|trans }}</th>
                    <th>{{ 'Geschlecht'|trans }}</th>
                    <th>{{ 'Geburtsdatum'|trans }}</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for p in participants %}
                    <tr>
                        <td>{{ p.import_id }}</td>
                        <td>{{ p.geschlecht }}</td>
                        <td>{{ p.geburtsdatum|date('d.m.Y') }}</td>
                        <td class="text-right">
                            <a
                                class="btn btn-primary btn-sm"
                                href="{{ path(
                                    'sportabzeichen_exam_disciplines',
                                    {
                                        examId: selectedExam,
                                        participantId: p.id
                                    }
                                ) }}"
                            >
                                {{ 'Disziplinen auswählen'|trans }}
                            </a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

    {% elseif selectedExam %}
        <p class="text-muted">
            {{ 'Keine Teilnehmer für diese Prüfung vorhanden.'|trans }}
        </p>
    {% endif %}

</div>
{% endblock %}
